= javascript_include_tag 'pages.js'

- if @current_user
  = link_to (t :new), new_page_path, :class => 'links'
  - @pages.each do |p|
    = link_to p.id, edit_page_path(p)
    
- @pages.each do |p|
  - partial_htmls = @partial_htmls_pages[p.id]
  - background_image = "background-image: url('#{ p.image }');" if p.image
  .page{ :id => "page_#{ p.id }", :style => "width: #{ p.width }px; height: #{ p.height }px; #{ background_image } background-color: #{ p.color }; position: absolute;" }
    = render :partial => 'page', :locals => { :page => p, :partial_htmls => partial_htmls }
    
:javascript
  var page_count = #{ @pages.count };
  var page_ids = #{ @pages_ids.to_s };