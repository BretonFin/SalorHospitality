#!/bin/bash -e

. /usr/share/debconf/confmodule

export RAILS_ENV=production
export PATH=$PATH:/opt/billgastro/bin

case $1 in
  remove)
    echo "prerm called with remove"
    #do something
  ;;
  upgrade)
    echo "prerm called with upgrade"
    db_input high billgastro/dbdump || true
    db_go
    cd /opt/billgastro/billgastro
    echo "Backing up database."
    mysqldump -u $username -p$password $database > database-backup.sql
  ;;
  *)
    echo "prerm called with unknown argument '$1'" 1>&2
    exit 1
  ;;
esac
