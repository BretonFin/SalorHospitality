%table.detailed_list
  %tr
    %th{ :style => 'width:280px' }= Item.model_name.human
    %th{ :style => 'width:70px' }= t '.count'
    %th{ :style => 'width:50px' }= t '.unit_price'
    %th{ :style => 'width:50px' }= t '.total'
    %th{ :style => 'width:80px' }= t '.revenue'
  - total = 0
  - @orders.each do |so|
    - next if @selected_cost_center and o.cost_center != @selected_cost_center
    - total += so.sum
    %tr
    %tr
      %td.order_begin{ :colspan => 6 }
        = t('.order_number_on_table_on_date', :order => Order.model_name.human, :number => so.nr, :table => so.table.name, :time => l(so.created_at, :format => :datetime_iso))
        %br
        == #{ User.model_name.human }: #{ so.user.title }
        %br
        == #{ CostCenter.model_name.human }: #{ so.cost_center.name if so.cost_center }
        %br
        = so.printed_from if so.printed_from
        %br
        = link_to t(:invoice), order_path(so)

      - so.items.each do |item|
        %tr
          %td= item.quantity ? "#{ item.quantity.prefix } #{ item.quantity.article.name } #{ item.quantity.postfix } #{ item.comment }" : "#{ item.article.name } #{ item.comment }"
          %td.number== #{ item.count } #{ '(max. ' + item.max_count.to_s + ')' if item.max_count != item.count }
          %td.number= number_to_currency item.price
          %td.colsum= number_to_currency item.total_price
        - item.options.each do |o|
          %tr
            %td= o.name
            %td.number= item.count
            %td.number= number_to_currency o.price
            %td.colsum= number_to_currency item.storno_status == 2 ? -(o.price * item.count) : o.price * item.count
    %tr
      %td.subtotal{ :colspan => 6 }= number_to_currency so.sum
        
  %tr.total
    %td.total{ :colspan => 6 }= number_to_currency total
