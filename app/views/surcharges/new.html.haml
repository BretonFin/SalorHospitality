%h2= @surcharge.new_record? ? (t '.new_surcharge') : (t '.edit_surcharge')

- if @surcharge.errors.any?
  .errors
    %h3= t 'activerecord.errors.template.header', :count => @surcharge.errors.size, :model => Surcharge.model_name.human
    %ul
      - @surcharge.errors.full_messages.each do |msg|
        %li= msg

.form_fields
  = form_for @surcharge do |surcharge_form|
    %p= submit_tag( controller.action_name == 'new' ? (t :create) : (t :edit) )
    = surcharge_form.label :name
    = surcharge_form.text_field :name
    %br
    = surcharge_form.label :season_id
    = surcharge_form.select :season_id, @seasons.collect{|s| [s.name,s.id]}, :include_blank => true
    %br
    = surcharge_form.label :guest_type_id
    = surcharge_form.select :guest_type_id, @guest_types.collect{|g| [g.name,g.id]}, :include_blank => true
    %br
    = surcharge_form.label :radio_select
    = surcharge_form.check_box :radio_select

    %div#tax_amounts
      %h3= t('activerecord.models.tax_amount.other')
      %p#add_tax_amount
        %span.link= t '.add_tax_amount'
    = surcharge_form.fields_for :tax_amounts, surcharge_form.object.tax_amounts.existing do |f|
      = render :partial => 'tax_amount', :locals => { :f => f }
    %script== var tax_amount_template = '#{ generate_template(surcharge_form, :tax_amounts) }'

:javascript
  $('#add_tax_amount').click(function(){
    var new_tax_amount_id = new Date().getTime();
    $('#tax_amounts').append(tax_amount_template.replace(/NEW_RECORD/g, 'new_' + new_tax_amount_id));
  });
